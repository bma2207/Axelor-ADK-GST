<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views
  http://axelor.com/xml/ns/object-views/object-views_5.0.xsd">

	<selection name="invoiceStatus">
		<option value="draft">DRAFT</option>
		<option value="validated">VALIDATED</option>
		<option value="paid">PAID</option>
		<option value="canceled">CANCELED</option>
	</selection>


	<grid name="invoice-grid" model="com.axelor.gst.db.Invoice" title="invoice-grid">
		<field name="status" widget="nav-select" selection="invoiceStatus"
			readonly="true" />
		<field name="company" />
		<field name="reference" />
		<field name="dateTime" />
		<field name="priority" />
		<field name="party" />
		<field name="partyContact" />
		<field name="invoiceAddress" />
		<field name="shippingAddress" />
		<field name="useInvoiceAddressAsShipping" />
		<field name="netAmount" />
		<field name="netIGST" />
		<field name="netSGST" />
		<field name="netCGST" />
		<field name="grossAmount" />
		<field name="invoiceItemsList" />
	</grid>
	<kanban name="incoice-kanban" title="invoice" model="com.axelor.gst.db.Invoice"
		columnBy="status" sequenceBy="priority" limit="10">
		<field name="party" />
		<field name="status" widget="nav-select" readonly="true"
			colSpan="8" />
		<field name="netAmount" />
		<field name="netIGST" />
		<field name="netSGST" />
		<field name="netCGST" />
		<field name="grossAmount" />

		<hilite color="danger" if="priority == 0" />
		<hilite color="success" if="priority == 10" />
		<hilite color="info" if="priority >= 15" />
		<hilite color="warning" if="priority > 0" />
		<template><![CDATA[
    <h4>{{name}}</h4>
  
    <div class="card-body">{{party.name}}<br>
    {{netAmount}}<br>
    {{netCGST}}<br>
    {{netSGST}}<br>
    {{grossAmount}}<br>
    </div>
    <div class="card-footer">
      <i class='fa fa-clock-o'></i> <span>{{startDate|date:'yyyy-MM-dd HH:mm:ss'}}</span>
    </div>
    ]]></template>
	</kanban>

	<form name="invoice-form" model="com.axelor.gst.db.Invoice" title="invoice-form"
		width="large" css="panel-pink" onNew="action-gst-product-ids" onSave="action-references">
		<toolbar>
			<button name="btnPrint" title="Print" showTitle="false"
				showIf="id" onClick="action-TakeImagePath-On-click" icon="fa-print" />
		</toolbar>

		<panel title="Create Invoice" colSpan="12">
			<field name="reference" title="Reference" colSpan="4" />
			<field name="status" widget="nav-select" readonly="true"
				colSpan="8" />
		</panel>

		<panel title="Party Details" colSpan="12">
			<field name="party" title="Party Name"
				onChange="action-group-of-set-check-party-address" />
			<field name="partyContact" title="Party Contact" domain="self.party =:party" />
		</panel>

		<panel title="Address Details" colSpan="12">
			<field name="invoiceAddress" title="Invoice Address" domain="self.partyAddress =:party"
				onChange="action-group-invoiceLitCalculation" />
			<field name="shippingAddress" title="Shipping Address" domain="self.partyAddress =:party" />
			<field name="inUseInvoiceAddressAsShipping" title="Use Invoice Address As Shipping"
				onChange="com.axelor.gst.controller.Invoicelinecontroller:setShippingAddress" />
		</panel>

		<panel title="Invoice Calculation" colSpan="12">
			<field name="netAmount" title="Net Amount" readonly="true" />
			<field name="netIGST" title="Net IGST" readonly="true" />
			<field name="netSGST" title="Net SGST" readonly="true" />
			<field name="netCGST" title="Net CGST" readonly="true" />
			<field name="grossAmount" title="Gross Amount" readonly="true" />
		</panel>

		<panel title="Invoice Items List" colSpan="12"
			readonlyIf="invoiceAddress == null &amp;&amp; company !=null">
			<field name="invoiceItemsList" colSpan="12" onChange="action-calculation" />
		</panel>

		<panel sidebar="true">
			<button name="Validated" title="Validated" onClick="action-validation"
				hidden="true" showIf="status == 'draft'" />
			<button name="Canceled" title="Canceled" onClick="action-Canceled"
				hidden="true" hideIf="status == 'paid' || status =='canceled' " />
			<button name="paid" title="Paid" onClick="action-paid" hidden="true"
				showIf="status == 'validated' " />
			<button name="draft" title="Draft" onClick="action-draft"
				hidden="true" showIf="status == 'validated' " />
		</panel>

		<panel sidebar="true">
			<field name="createdOn" />
			<field name="updatedOn" />
		</panel>
		<panel sidebar="true">
			<field name="company" title="Company" />
			<field name="dateTime" title="Date Of Invoice" expr="eval:  __datetime__" />
			<field name="priority" title="Priority" />
		</panel>
	</form>

	<action-record name="action-gst-invoice-record-default-dt"
		model="com.axelor.gst.db.Invoice">
		<field name="dateTime" expr="eval: __datetime__" />
		<field name="company" expr="eval: __repo__(Company).all().fetchOne() " />
	</action-record>

	<action-attrs name="action-validation">
		<attribute name="value" for="status" expr="validated" />
	</action-attrs>

	<action-attrs name="action-draft">
		<attribute name="value" for="status" expr="draft" />
	</action-attrs>

	<action-attrs name="action-Canceled">
		<attribute name="value" for="status" expr="canceled" />
	</action-attrs>

	<action-attrs name="action-paid">
		<attribute name="value" for="status" expr="paid" />
	</action-attrs>

	<action-method name="action-calculation">
		<call class="com.axelor.gst.controller.Invoicelinecontroller"
			method="onCalculation" />
	</action-method>

	<action-report name="print.WithImage" design="invoice.rptdesign"
		output="so-${date}${time}" format="pdf">
		<param name="param" expr="eval:id" />
		<param name="AttachmentPath" expr="eval:AttachmentPath" />
	</action-report>


	<action-group name="action-TakeImagePath-On-click">
		<action name="action-AttechMentPath" />
		<action name="print.WithImage" />
	</action-group>
	<action-method name="action-AttechMentPath">
		<call class="com.axelor.gst.controller.ReportImagePath" method="ImagePath" />
	</action-method>
	<action-method name="action-gst-product">
		<call class="com.axelor.gst.controller.ProductIds" method="productIdsList" />
	</action-method>
	<action-group name="action-gst-product-ids">
		<action name="action-gst-product" />
		<action name="action-gst-invoice-record-default-dt" />

	</action-group>
	<action-method name="action-references">
		<call class="com.axelor.gst.controller.SequenceCreate" method="setSequence" />
	</action-method>
	<action-method name="action-invoiceListCalculation">
		<call class="com.axelor.gst.controller.InvoiceListCalculation"
			method="CalculateinvoiceList" />
	</action-method>
	<action-method name="action-calculation-price">
		<call class="com.axelor.gst.controller.Invoicelinecontroller"
			method="calnetamount" />
	</action-method>
	<action-group name="action-group-invoiceLitCalculation">
		<action name="action-invoiceListCalculation" />
		<action name="action-calculation" />
	</action-group>
	<action-method name="action-prty-address-set">
		<call class="com.axelor.gst.controller.Invoicelinecontroller"
			method="setPartyContact" />
	</action-method>
	<action-method name="action-prty-address-check">
		<call class="com.axelor.gst.controller.PartySelection" method="CalculateinvoiceList" />
	</action-method>
	<action-method name="action-party-invoice-calculaion">
	<call class="com.axelor.gst.controller.PartySelection" method="onCalculation"/>
	</action-method>
	<action-group name="action-group-of-set-check-party-address">
		<action name="action-prty-address-check" />
		<action name="action-prty-address-set" />
		<action name="action-party-invoice-calculaion"/>
	</action-group>

</object-views>